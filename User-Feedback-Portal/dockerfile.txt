# ------------------------------
# Stage 1: Copy frontend files
# ------------------------------
FROM node:alpine AS frontend-build

# Set working directory for frontend
WORKDIR /app/frontend

# Copy static frontend files (HTML, CSS, JS)
COPY frontend/ ./

RUN npm install


# ------------------------------
# Stage 2: Setup backend
# ------------------------------
FROM node:alpine

# Set working directory for backend
WORKDIR /app/backend

# Copy backend files
COPY backend/ ./

# Install backend dependencies
RUN npm install

# Copy frontend static files into backend's public folder (no build folder)
COPY --from=frontend-build /app/frontend ./public

# Expose backend port
EXPOSE 5000

# Start the backend
CMD ["node", "server.js"]
